<!DOCTYPE html>
<html>
	<head>
	<meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ask w8ball</title>
	
	<style>

        body {
            background-color: black;
            
        }
        
        #centered {
            margin: 0 auto;
            width: 450px;
        }
        
        hr {
            border-top: 1px solid white;
            width: 100%;
        }
        
        #centered div {
            margin: 5em;
        }

        #w8ballAnswerText {
            font: bold 1.5em "Courier New";
            color: white;
        }
        
        #footer {
            position: absolute;
            right: 0;
            bottom: 0;
            left: 0;
            padding: 1rem;
            text-align: right;
            border-top: 1px solid white;
            color: white;
        }
        
		.hidden { display:none;}
		
        .menu {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
        }
        
        .menu p {
            margin: 0 auto;
        }

		
        /* spinner */
        
		#loader {
		  border: 16px solid #f3f3f3;
		  border-radius: 50%;
		  border-top: 16px solid #3498db;
		  width: 30px;
		  height: 30px;
		  -webkit-animation: spin 2s linear infinite; /* Safari */
		  animation: spin 2s linear infinite;
		}
		
		/* Safari */
		@-webkit-keyframes spin {
		  0% { -webkit-transform: rotate(0deg); }
		  100% { -webkit-transform: rotate(360deg); }
		}
		
		@keyframes spin {
		  0% { transform: rotate(0deg); }
		  100% { transform: rotate(360deg); }
		}
        
        /* end spinner */
        
        
        /* smokey text effect */
        span {
            text-shadow: 0 0 0 whitesmoke;
        }
        

        @keyframes smoky {
          60% {
            text-shadow: 0 0 20px whitesmoke;
          }
          to {
            transform:
              translate3d(-15rem,-8rem,0)
              rotate(40deg)
              skewX(-70deg)
              scale(1.5);
            opacity: 0;
          }
        }
        /* end smokey text effext */

        
</style>
	
	</head>

	<body>
        
        
        <div id="centered">
            
            <div id="w8ballQuestion">
                <form name="w8ballForm">
                    <input autofocus type="text" size="35"  id="w8ballQuestionText" placeholder="your question here">
                    <button>Ask!</button>
                </form>
            </div>
		
            <div id="w8ball">
                <div id="loader" class="hidden"></div>	
            </div>

            <div id="w8ballAnswer">
                <p id="w8ballAnswerText">
                   
                </p>
            </div>

        </div>
            
        <div id="footer" class="menu">
                <p>About</p>
                <p><img alt="avatar" src="https://www.gravatar.com/avatar/dd666ee8bef207889d2325f077228054.jpg?s=50" /></p>        
        </div>

		
		<script>
			const form = document.getElementsByName('w8ballForm')[0];
			const w8ballQuestionText = document.getElementById('w8ballQuestionText');
			const w8ballAnswerText = document.getElementById('w8ballAnswerText');
			
			const supportedLanguages = ['nl','fr','en','de'];
			
            /**
            * ANSWERS
            */
			const fat = {
                text:{
                    nl:"neen - je bent nu al dik",
                    fr:"non - t'es déjà trop gros",
                    en:"no - you're fat already",
                    de:"nein - du bisst jetzt zu fett"
                },
                imageSrc:'./slimming-2728331_640.jfif'
            };
									
			const dont = {
                text: {
                    nl:"niet doen - je zal het je morgen beklagen",
                    fr:"non - tu le regretteras demain",
                    en:"don't - you'll regret it tomorrow",
                    de:"nein - sie werden es morgen bereuen"
                },
                imageSrc:'./nature-3238937_640.jfif'
            };
			
			const answers = [fat,dont];
			
            /**
            * STOP ANSWERS
            */
            
			form.onsubmit = function(event){
				//prevent page from reloading and clearing the answer's text and image
				event.preventDefault();
				
				//clean up eventual previous searchresult
				w8ballAnswerText.textContent = '';
				
				
				think();	
			}
			
			function think(){								
				const answer = answers[getRandomInt(0,answers.length)];
                
                /* TODO
                check again when working on internationalization 
				const browserLanguage = navigator.language.substring(0,2).toLowerCase();
				
				//default to english in case we don't support the user's language yet
				const answerTextLanguage = supportedLanguages.indexOf(browserLanguage)>-1 ? browserLanguage : 'en';
				
                */
                
                const answerTextLanguage = 'en';
				const answerString = answer.text[answerTextLanguage];
                
                for(i=0;i<answerString.length;i -=- 1){
                    var answerSpan = document.createElement('span');
                    answerSpan.setAttribute('id','s'+i);
                    answerSpan.setAttribute('style','animation: smoky 5s ' +(i+0.5)+ 's both;animation-direction: reverse;');
        
                    const currentChar = answerString[i];
                    if(currentChar ===' '){
                        answerSpan.innerHTML = "&nbsp;";
                    } else {
                        answerSpan.textContent  = currentChar;
                    }
                    w8ballAnswerText.appendChild(answerSpan);
                    
                }
                
				
				//clear question text
				w8ballQuestionText.value = "";
				
				document.getElementById('loader').style.display = 'none';
				
			}
			
			/*
			*	below function returns a number between a minimum (inclusive) and a maximum (exclusive)
			* source: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random
			*/
			function getRandomInt(min, max) {
  			min = Math.ceil(min);
  			max = Math.floor(max);
  			return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive
			}
		</script>
		
	</body>

</html> 